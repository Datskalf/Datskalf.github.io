<!DOCTYPE html>
<HTML>
    <head>
        <title>Velvet controller</title>
        <style>
            canvas {
                max-width: 200px;
                width: 33%;
                aspect-ratio: 1/1;
            }

            .dirBtn {
                background-color: red;
            }

            .actionBtn {
                background-color: blue;
            }
        </style>
    </head>
    <body>
        <div id="buttonGrid">
            <div class="gridrow">
                <p>Last command: </p>
                <p id="output"></p>
            </div>
            <div class="gridrow" id="row1">
                <canvas></canvas>
                <canvas class="dirBtn" id="btnUp"></canvas>
                <canvas></canvas>
            </div>
            <div class="gridrow" id="row2">
                <canvas class="dirBtn" id="btnLeft"></canvas>
                <canvas class="actionBtn" id="btnFire"></canvas>
                <canvas class="dirBtn" id="btnRight"></canvas>
            </div>
            <div class="gridrow" id="row3">
                <canvas></canvas>
                <canvas class="dirBtn" id="btnDown"></canvas>
                <canvas></canvas>
            </div>
        </div>

        <script>
            var btnUp = document.getElementById("btnUp");
            var btnDown = document.getElementById("btnDown");
            var btnLeft = document.getElementById("btnLeft");
            var btnRight = document.getElementById("btnRight");
            var btnFire = document.getElementById("btnFire");
            var output = document.getElementById("output");

            btnUp.addEventListener("onmousedown", function() {sendDirection({"action": "DRIVE", "button": "UP", "state": true})});
            btnUp.addEventListener("pointerdown", function() {sendDirection({"action": "DRIVE", "button": "UP", "state": true})});
            btnUp.addEventListener("onmouseup", function() {sendDirection({"action": "DRIVE", "button": "UP", "state": false})});
            btnUp.addEventListener("pointerup", function() {sendDirection({"action": "DRIVE", "button": "UP", "state": false})});

            btnDown.addEventListener("onmousedown", function() {sendDirection({"action": "DRIVE", "button": "DOWN", "state": true})});
            btnDown.addEventListener("pointerdown", function() {sendDirection({"action": "DRIVE", "button": "DOWN", "state": true})});
            btnDown.addEventListener("onmouseup", function() {sendDirection({"action": "DRIVE", "button": "DOWN", "state": false})});
            btnDown.addEventListener("pointerup", function() {sendDirection({"action": "DRIVE", "button": "DOWN", "state": false})});

            btnLeft.addEventListener("onmousedown", function() {sendDirection({"action": "DRIVE", "button": "LEFT", "state": true})});
            btnLeft.addEventListener("pointerdown", function() {sendDirection({"action": "DRIVE", "button": "LEFT", "state": true})});
            btnLeft.addEventListener("onmouseup", function() {sendDirection({"action": "DRIVE", "button": "LEFT", "state": false})});
            btnLeft.addEventListener("pointerup", function() {sendDirection({"action": "DRIVE", "button": "LEFT", "state": false})});

            btnRight.addEventListener("onmousedown", function() {sendDirection({"action": "DRIVE", "button": "RIGHT", "state": true})});
            btnRight.addEventListener("pointerdown", function() {sendDirection({"action": "DRIVE", "button": "RIGHT", "state": true})});
            btnRight.addEventListener("onmouseup", function() {sendDirection({"action": "DRIVE", "button": "RIGHT", "state": false})});
            btnRight.addEventListener("pointerup", function() {sendDirection({"action": "DRIVE", "button": "RIGHT", "state": false})});

            btnFire.addEventListener("onmousedown", function() {sendAction({"action": "FIRE", "state": false})});
            btnFire.addEventListener("pointerdown", function() {sendAction({"action": "FIRE", "state": false})});
            btnFire.addEventListener("onmouseup", function() {sendAction({"action": "FIRE", "state": false})});
            btnFire.addEventListener("pointerup", function() {sendAction({"action": "FIRE", "state": false})});



            function sendData(data) {
                output.innerText = JSON.stringify(data);
                return;
                send(data)
            }

            function send(data) {
                fetch("http://datsom.local:8080", {
                    method: "POST",
                    headers: {
                        "Accept": "application/json",
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                })
                .then(response => response.json())
                .then(response => console.log(JSON.stringify(response)))
            }
        </script>
    </body>
</HTML>